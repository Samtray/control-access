/* ---------------------------------------------------- */
/*  GENERATED BY ENTERPRISE ARCHITECT VERSION 13.5 		*/
/*  CREATED ON : 21-JUN.-2022 07:00:24 P. M. 				*/
/*  DBMS       : MYSQL 						*/
/* ---------------------------------------------------- */
DROP DATABASE IF EXISTS CTL_ACCESS;
CREATE DATABASE CTL_ACCESS;
USE CTL_ACCESS;

SET FOREIGN_KEY_CHECKS=0;

/* DROP TABLES */

DROP TABLE IF EXISTS `ACCESS_LEVEL` CASCADE;

DROP TABLE IF EXISTS `CARD` CASCADE;

DROP TABLE IF EXISTS `DEPARTMENT` CASCADE;

DROP TABLE IF EXISTS `EMPLOYEE` CASCADE;

DROP TABLE IF EXISTS `EMPLOYEE_ACCESS_LEVEL` CASCADE;

DROP TABLE IF EXISTS `POSITION` CASCADE;

DROP TABLE IF EXISTS `SHIFT` CASCADE;

/* CREATE TABLES */

CREATE TABLE `ACCESS_LEVEL`
(
	`ACCESS_LEVEL_ID` INT NOT NULL AUTO_INCREMENT,
	`NAME` VARCHAR(50) NOT NULL,
	`STATUS` VARCHAR(20) NOT NULL DEFAULT 'ENABLED',
	`CREATED_ON` DATETIME NOT NULL DEFAULT NOW(),
	`CREATED_BY` VARCHAR(40),
	`UPDATED_ON` DATETIME,
	`UPDATED_BY` VARCHAR(40),
	CONSTRAINT `PK_ACCESS_LEVEL` PRIMARY KEY (`ACCESS_LEVEL_ID` ASC)
);

CREATE TABLE `CARD`
(
	`CARD_ID` INT NOT NULL AUTO_INCREMENT,
	`NUMBER` VARCHAR(20) NOT NULL,
	`STATUS` VARCHAR(20) NOT NULL DEFAULT 'ENABLED',
	`CREATED_ON` DATETIME NOT NULL DEFAULT NOW(),
	`CREATED_BY` VARCHAR(40),
	`UPDATED_ON` DATETIME,
	`UPDATED_BY` VARCHAR(40),
	CONSTRAINT `PK_CARD` PRIMARY KEY (`CARD_ID` ASC)
);

CREATE TABLE `DEPARTAMENT`
(
	`DEPARTAMENT_ID` INT NOT NULL AUTO_INCREMENT,
	`NAME` VARCHAR(50) NOT NULL,
	`CODE` VARCHAR(20) NOT NULL,
	`STATUS` VARCHAR(20) NOT NULL DEFAULT 'ENABLED',
	`CREATED_ON` DATETIME NOT NULL DEFAULT NOW(),
	`CREATED_BY` VARCHAR(40),
	`UPDATED_ON` DATETIME,
	`UPDATED_BY` VARCHAR(40),
	CONSTRAINT `PK_DEPARTMENT` PRIMARY KEY (`DEPARTAMENT_ID` ASC)
);

CREATE TABLE `EMPLOYEE`
(
	`EMPLOYEE_ID` INT NOT NULL AUTO_INCREMENT,
	`FIRST_NAME` VARCHAR(50) NOT NULL,
	`LAST_NAME` VARCHAR(50) NULL,
	`POSITION_ID` INT NULL,
	`SHIFT` INT NULL,    
	`IMAGE` LONGBLOB,
	`STATUS` VARCHAR(20) NOT NULL DEFAULT 'ENABLED',
	`CREATED_ON` DATETIME NOT NULL DEFAULT NOW(),
	`CREATED_BY` VARCHAR(40),
	`UPDATED_ON` DATETIME,
	`UPDATED_BY` VARCHAR(40),
	CONSTRAINT `PK_EMPLOYEE` PRIMARY KEY (`EMPLOYEE_ID` ASC)
);

CREATE TABLE `EMPLOYEE_ACCESS_LEVEL`
(
	`EMPLOYEE_ID` INT NOT NULL,
	`ACCESS_LEVEL_ID` INT NOT NULL,
    `STATUS` VARCHAR(20) NOT NULL DEFAULT 'ENABLED',
	CONSTRAINT `PK_EMPLOYEE_ACCESS_LEVEL` PRIMARY KEY (`EMPLOYEE_ID` ASC, `ACCESS_LEVEL_ID` ASC)
);

CREATE TABLE `POSITION`
(
	`POSITION_ID` INT NOT NULL AUTO_INCREMENT,
	`NAME` VARCHAR(50) NOT NULL,
    `DEPARTAMENT_ID` INT NOT NULL,
	`STATUS` VARCHAR(20) NOT NULL DEFAULT 'ENABLED',
	`CREATED_ON` DATETIME NOT NULL DEFAULT NOW(),
	`CREATED_BY` VARCHAR(40),
	`UPDATED_ON` DATETIME,
	`UPDATED_BY` VARCHAR(40),
	CONSTRAINT `PK_POSITION` PRIMARY KEY (`POSITION_ID` ASC)
);

CREATE TABLE `SHIFT`
(
	`SHIFT_ID` INT NOT NULL AUTO_INCREMENT,
	`NAME` VARCHAR(50) NOT NULL,
	`CLOCK_IN` TIME NOT NULL,
	`CLOCK_OUT` TIME NOT NULL,
	`LUNCH_TIME` TIME NOT NULL,
	CONSTRAINT `PK_SHIFTS` PRIMARY KEY (`SHIFT_ID` ASC)
);

/* CREATE PRIMARY KEYS, INDEXES, UNIQUES, CHECKS */

ALTER TABLE `EMPLOYEE` 
 ADD INDEX `IXFK_EMPLOYEE_POSITION` (`POSITION_ID` ASC);

ALTER TABLE `EMPLOYEE` 
 ADD INDEX `IXFK_EMPLOYEE_SHIFTS` (`SHIFT` ASC);

ALTER TABLE `EMPLOYEE_ACCESS_LEVEL` 
 ADD INDEX `IXFK_EMPLOYEE_ACCESS_LEVEL_ACCESS_LEVEL` (`ACCESS_LEVEL_ID` ASC);

ALTER TABLE `EMPLOYEE_ACCESS_LEVEL` 
 ADD INDEX `IXFK_EMPLOYEE_ACCESS_LEVEL_EMPLOYEE` (`EMPLOYEE_ID` ASC);

ALTER TABLE `POSITION` 
 ADD INDEX `IXFK_POSITION_DEPARTMENT` (`DEPARTAMENT_ID` ASC);

/* CREATE FOREIGN KEY CONSTRAINTS */

ALTER TABLE `EMPLOYEE` 
 ADD CONSTRAINT `FK_EMPLOYEE_POSITION`
FOREIGN KEY (`POSITION_ID`) REFERENCES `POSITION` (`POSITION_ID`) ON DELETE RESTRICT ON UPDATE RESTRICT;

ALTER TABLE `EMPLOYEE` 
 ADD CONSTRAINT `FK_EMPLOYEE_SHIFTS`
FOREIGN KEY (`SHIFT`) REFERENCES `SHIFT` (`SHIFT_ID`) ON DELETE RESTRICT ON UPDATE RESTRICT;

ALTER TABLE `EMPLOYEE_ACCESS_LEVEL` 
 ADD CONSTRAINT `FK_EMPLOYEE_ACCESS_LEVEL_ACCESS_LEVEL`
FOREIGN KEY (`ACCESS_LEVEL_ID`) REFERENCES `ACCESS_LEVEL` (`ACCESS_LEVEL_ID`) ON DELETE RESTRICT ON UPDATE RESTRICT;

ALTER TABLE `EMPLOYEE_ACCESS_LEVEL` 
 ADD CONSTRAINT `FK_EMPLOYEE_ACCESS_LEVEL_EMPLOYEE`
FOREIGN KEY (`EMPLOYEE_ID`) REFERENCES `EMPLOYEE` (`EMPLOYEE_ID`) ON DELETE RESTRICT ON UPDATE RESTRICT;

ALTER TABLE `POSITION` 
 ADD CONSTRAINT `FK_POSITION_DEPARTMENT`
FOREIGN KEY (`DEPARTAMENT_ID`) REFERENCES `DEPARTAMENT` (`DEPARTAMENT_ID`) ON DELETE RESTRICT ON UPDATE RESTRICT;

SET FOREIGN_KEY_CHECKS=1;
